<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detective Stories: Murder Mysteries</title>
    <link rel="icon" type="image/png" href="https://github.com/TitanBusinessPros/Detective/raw/main/Detective-Favicon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Georgia', serif;
        }

        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 100%;
            max-width: 1000px;
            height: 95vh;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 2px solid #4a4a6a;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        /* Main Menu Styles */
        #main-menu {
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23262638"/><path d="M0 50 L100 50 M50 0 L50 100" stroke="%2333334d" stroke-width="1"/></svg>');
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }

        .menu-title {
            font-size: 3.5rem;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px rgba(0, 150, 255, 0.7);
            color: #ffffff;
        }

        .menu-subtitle {
            font-size: 1.5rem;
            margin-bottom: 3rem;
            color: #cccccc;
            max-width: 600px;
            line-height: 1.6;
        }

        .case-buttons {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            width: 300px;
        }

        .case-btn {
            padding: 15px 30px;
            font-size: 1.2rem;
            background: #2d2d44;
            color: #e6e6e6;
            border: 2px solid #4a4a6a;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .case-btn:hover {
            background: #3a3a5a;
            border-color: #5a5a8a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Game Screen Styles */
        #game-screen {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
        }

        #game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #2d2d44;
            border-bottom: 2px solid #4a4a6a;
        }

        #game-logo {
            width: 200px;
            height: 40px;
            background-image: url('https://github.com/TitanBusinessPros/Detective/raw/main/Detective%20Logo.png');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #game-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            padding: 8px 15px;
            background: #3a3a5a;
            color: #e6e6e6;
            border: 1px solid #4a4a6a;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .control-btn:hover {
            background: #4a4a6a;
        }

        #game-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        #game-main {
            flex: 3;
            display: flex;
            flex-direction: column;
        }

        #background {
            flex: 1;
            background-size: cover;
            background-position: center;
            transition: background-image 0.5s ease;
        }

        #dialogue-container {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-top: 2px solid #4a4a6a;
            min-height: 40%;
        }

        #speaker-name {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #ffcc00;
        }

        #dialogue-text {
            font-size: 1.2rem;
            line-height: 1.5;
            margin-bottom: 20px;
            min-height: 80px;
        }

        #choices-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .choice-btn {
            padding: 12px 20px;
            background: #2d2d44;
            color: #e6e6e6;
            border: 1px solid #4a4a6a;
            border-radius: 5px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s ease;
        }

        .choice-btn:hover {
            background: #3a3a5a;
            border-color: #5a5a8a;
        }

        /* Notepad Styles */
        #notepad-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #2d2d44;
            border-left: 2px solid #4a4a6a;
            max-width: 300px;
        }

        #notepad-header {
            padding: 10px;
            background: #3a3a5a;
            border-bottom: 1px solid #4a4a6a;
            text-align: center;
            font-weight: bold;
        }

        #notepad {
            flex: 1;
            padding: 15px;
            background: #1a1a2e;
            border: none;
            color: #e6e6e6;
            font-size: 1rem;
            line-height: 1.5;
            resize: none;
            outline: none;
        }

        #notepad::placeholder {
            color: #888;
        }

        /* Ending Screen Styles */
        #ending-screen {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8));
        }

        .ending-title {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #ffcc00;
        }

        .ending-text {
            font-size: 1.3rem;
            line-height: 1.6;
            max-width: 800px;
            margin-bottom: 2rem;
        }

        .ending-buttons {
            display: flex;
            gap: 20px;
        }

        .ending-btn {
            padding: 12px 25px;
            font-size: 1.1rem;
            background: #2d2d44;
            color: #e6e6e6;
            border: 2px solid #4a4a6a;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ending-btn:hover {
            background: #3a3a5a;
            border-color: #5a5a8a;
        }

        /* Background Classes */
        .bg-penthouse {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23111e30"/><rect x="20" y="20" width="60" height="40" fill="%233d5a80" opacity="0.7"/><rect x="30" y="30" width="40" height="20" fill="%23e0fbfc"/><circle cx="50" cy="40" r="5" fill="%23ff9e00"/></svg>');
        }

        .bg-boardwalk {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%2306396e"/><rect y="70" width="100" height="30" fill="%238B4513"/><path d="M0 40 L100 40 M0 45 L100 45 M0 50 L100 50 M0 55 L100 55 M0 60 L100 60" stroke="%23DEB887" stroke-width="2"/><circle cx="20" cy="30" r="15" fill="%23FFD700"/></svg>');
        }

        .bg-theater {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232c0735"/><rect x="10" y="20" width="80" height="60" fill="%235a189a"/><rect x="15" y="25" width="70" height="50" fill="%239d4edd"/><path d="M15 25 L85 25 L90 15 L10 15 Z" fill="%235a189a"/><circle cx="50" cy="40" r="10" fill="%23ff9e00"/></svg>');
        }

        .bg-police-station {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%233a3a3a"/><rect x="20" y="20" width="60" height="60" fill="%235a5a5a"/><rect x="30" y="30" width="40" height="40" fill="%237a7a7a"/><rect x="40" y="40" width="20" height="20" fill="%23ffcc00"/></svg>');
        }

        .bg-interview-room {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23454545"/><rect x="10" y="10" width="80" height="80" fill="%23606060" stroke="%23808080" stroke-width="2"/><rect x="20" y="20" width="60" height="40" fill="%237a7a7a"/><rect x="30" y="65" width="40" height="15" fill="%235a5a5a"/></svg>');
        }
        
        .bg-office {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232c3e50"/><rect x="20" y="20" width="60" height="60" fill="%23444"/><rect x="25" y="25" width="50" height="40" fill="%23555"/><rect x="30" y="30" width="40" height="25" fill="%23666"/><rect x="35" y="60" width="30" height="15" fill="%23555"/></svg>');
        }
        
        .bg-docks {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%2306396e"/><rect y="70" width="100" height="30" fill="%238B4513"/><path d="M0 40 L100 40 M0 45 L100 45 M0 50 L100 50 M0 55 L100 55 M0 60 L100 60" stroke="%23DEB887" stroke-width="2"/><rect x="10" y="30" width="20" height="40" fill="%23A52A2A"/><rect x="70" y="30" width="20" height="40" fill="%23A52A2A"/></svg>');
        }
        
        .bg-mansion {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23222233"/><rect x="30" y="40" width="40" height="40" fill="%23555"/><path d="M30 40 L50 20 L70 40" fill="%23777"/><rect x="40" y="50" width="20" height="30" fill="%23333"/><rect x="35" y="55" width="10" height="10" fill="%23aaa"/><rect x="55" y="55" width="10" height="10" fill="%23aaa"/></svg>');
        }
        
        .bg-backstage {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23333"/><rect x="10" y="10" width="80" height="80" fill="%23555" stroke="%23777" stroke-width="2"/><rect x="20" y="20" width="60" height="30" fill="%23666"/><rect x="25" y="25" width="50" height="20" fill="%23777"/><rect x="30" y="60" width="40" height="20" fill="%23666"/><rect x="35" y="65" width="30" height="10" fill="%23777"/></svg>');
        }

        /* Music Controls */
        #music-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .music-btn {
            padding: 8px 15px;
            background: rgba(45, 45, 68, 0.8);
            color: #e6e6e6;
            border: 1px solid #4a4a6a;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .music-btn:hover {
            background: rgba(58, 58, 90, 0.8);
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Main Menu Screen -->
        <div id="main-menu">
            <h1 class="menu-title">DETECTIVE STORIES</h1>
            <p class="menu-subtitle">Solve the unsolvable. Find the truth. Three challenging murder mysteries await your investigation.</p>
            <div class="case-buttons">
                <button class="case-btn" data-case="1">Case 1: The CEO's Penthouse</button>
                <button class="case-btn" data-case="2">Case 2: The Boardwalk Incident</button>
                <button class="case-btn" data-case="3">Case 3: The Theater Poisoning</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen">
            <div id="game-header">
                <div id="game-logo"></div>
                <div id="game-controls">
                    <button class="control-btn" id="toggle-notepad">Toggle Notepad</button>
                    <button class="control-btn" id="restart-case-btn">Restart Case</button>
                    <button class="control-btn" id="main-menu-btn">Main Menu</button>
                </div>
            </div>
            <div id="game-content">
                <div id="game-main">
                    <div id="background" class="bg-police-station"></div>
                    <div id="dialogue-container">
                        <div id="speaker-name">Detective</div>
                        <div id="dialogue-text">Welcome to the case. Let's begin our investigation.</div>
                        <div id="choices-container">
                            <!-- Choice buttons will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
                <div id="notepad-container" style="display: none;">
                    <div id="notepad-header">Detective's Notepad</div>
                    <textarea id="notepad" placeholder="Take notes about the case here..."></textarea>
                </div>
            </div>
        </div>

        <!-- Ending Screen -->
        <div id="ending-screen">
            <h2 class="ending-title">Case Resolved</h2>
            <div class="ending-text" id="ending-text">
                The case has been solved. Justice has been served.
            </div>
            <div class="ending-buttons">
                <button class="ending-btn" id="restart-case">Play Case Again</button>
                <button class="ending-btn" id="return-menu">Return to Menu</button>
            </div>
        </div>
    </div>
    
    <!-- Background Music -->
    <audio id="background-music" loop>
        <source src="https://github.com/TitanBusinessPros/Detective/raw/main/Detective%20Theme%20Song.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        // Game State
        const gameState = {
            currentCase: null,
            clues: {},
            suspectTrust: {
                mara: 0,
                alex: 0,
                victor: 0,
                elena: 0,
                benjamin: 0,
                isabella: 0,
                jack: 0,
                olivia: 0,
                marco: 0,
                victoria: 0,
                arthur: 0
            },
            flags: {},
            notes: ""
        };

        // Background Music
        const backgroundMusic = document.getElementById('background-music');
        let musicStarted = false;
        
        // Function to start music on user interaction
        function startMusicOnInteraction() {
            if (!musicStarted) {
                backgroundMusic.play().then(() => {
                    musicStarted = true;
                    console.log("Background music started");
                }).catch(error => {
                    console.log("Music play failed, waiting for user interaction:", error);
                });
            }
        }
        
        // Set up event listeners for user interaction
        document.addEventListener('click', startMusicOnInteraction);
        document.addEventListener('keydown', startMusicOnInteraction);

        // Sound Effects
        const sounds = {
            click: new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
            sting: new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
            door: new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
            crowd: new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==')
        };

        // Scene System
        const scenes = {};

        // Case 1: Locked-room tech CEO penthouse murder
        // This case will have 30+ choices and 3 endings
        scenes["case1_intro"] = {
            background: "bg-penthouse",
            speaker: "Dispatch",
            text: "Detective, we have a situation at the Aethelred Tech headquarters. CEO Marcus Aethelred has been found dead in his locked penthouse. The preliminary report suggests foul play. You're the lead on this case.",
            choices: [
                { label: "Head to the penthouse immediately", nextScene: "case1_penthouse_arrival" },
                { label: "First review the case files", nextScene: "case1_review_files" }
            ],
            sfx: "sting"
        };

        scenes["case1_review_files"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "Looking at the files: Marcus Aethelred, 52, tech billionaire. No known enemies but had several business rivals. Lives alone in a high-security penthouse. Body discovered by his assistant Mara at 8:00 AM.",
            choices: [
                { label: "Head to the penthouse now", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_penthouse_arrival"] = {
            background: "bg-penthouse",
            speaker: "Officer Miller",
            text: "Detective, glad you're here. The victim is Marcus Aethelred, founder of Aethelred Tech. The body was discovered by his assistant, Mara, this morning. The penthouse was locked from inside when she arrived.",
            choices: [
                { label: "Examine the body", nextScene: "case1_examine_body" },
                { label: "Question Mara", nextScene: "case1_question_mara" },
                { label: "Look for entry points", nextScene: "case1_look_entry" }
            ]
        };

        scenes["case1_examine_body"] = {
            background: "bg-penthouse",
            speaker: "Forensic Expert",
            text: "The victim has a single stab wound to the chest. The weapon appears to be missing. No signs of struggle. Time of death estimated between 10 PM and midnight last night.",
            choices: [
                { label: "Look for the murder weapon", nextScene: "case1_find_weapon" },
                { label: "Check the victim's personal effects", nextScene: "case1_personal_effects" },
                { label: "Return to the main room", nextScene: "case1_penthouse_arrival" }
            ],
            effect: function() { addClue("bodyExamined"); }
        };

        scenes["case1_question_mara"] = {
            background: "bg-penthouse",
            speaker: "Mara",
            text: "I found him like this when I arrived this morning. I have a key to the penthouse, but it was double-locked from inside. I don't understand how this could happen. Mr. Aethelred was a private man, but he had been stressed lately.",
            choices: [
                { label: "Ask about his recent stress", nextScene: "case1_mara_stress" },
                { label: "Ask about his relationships", nextScene: "case1_mara_relationships" },
                { label: "Return to investigation", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_mara_stress"] = {
            background: "bg-penthouse",
            speaker: "Mara",
            text: "He was working on a major merger with Apex Industries. There was some tension with his business partner, Alex, who felt the terms weren't favorable. And his ex-wife Elena had been calling more frequently.",
            choices: [
                { label: "Ask about Alex", nextScene: "case1_mara_alex" },
                { label: "Ask about Elena", nextScene: "case1_mara_elena" },
                { label: "Return to other questions", nextScene: "case1_question_mara" }
            ]
        };

        scenes["case1_mara_alex"] = {
            background: "bg-penthouse",
            speaker: "Mara",
            text: "Alex was here yesterday afternoon. They had a heated argument about the merger. Alex was angry that Marcus was considering other offers. I heard Alex say 'This isn't over, Marcus.' before he stormed out.",
            choices: [
                { label: "That sounds threatening", nextScene: "case1_mara_alex_threat" },
                { label: "Ask about other visitors", nextScene: "case1_mara_visitors" }
            ]
        };

        scenes["case1_mara_alex_threat"] = {
            background: "bg-penthouse",
            speaker: "Mara",
            text: "It did sound threatening, but Alex says things like that sometimes. He has a temper but he's never been violent. Still, with everything that's happened...",
            choices: [
                { label: "Make a note to question Alex", nextScene: "case1_after_mara" },
                { label: "Ask about security systems", nextScene: "case1_mara_security" }
            ],
            effect: function() { 
                addClue("alexArgument"); 
                modifyTrust("alex", -1);
            }
        };

        scenes["case1_mara_security"] = {
            background: "bg-penthouse",
            speaker: "Mara",
            text: "The penthouse has a state-of-the-art security system with cameras in the hallway and lobby. All access is logged. There's also a safe room that only Marcus knew how to access.",
            choices: [
                { label: "Check the security logs", nextScene: "case1_check_security" },
                { label: "Return to other questions", nextScene: "case1_question_mara" }
            ]
        };

        scenes["case1_check_security"] = {
            background: "bg-penthouse",
            speaker: "Security Technician",
            text: "The logs show Mara entered at 8:02 AM today. Before that, Marcus Aethelred entered at 6:15 PM yesterday. There's a gap in the hallway camera footage from 10:30 PM to 11:00 PM last night - system maintenance.",
            choices: [
                { label: "That's suspicious timing", nextScene: "case1_security_gap" },
                { label: "Return to investigation", nextScene: "case1_penthouse_arrival" }
            ],
            effect: function() { addClue("securityGap"); }
        };

        scenes["case1_security_gap"] = {
            background: "bg-penthouse",
            speaker: "Security Technician",
            text: "The maintenance was scheduled, but the timing is coincidental with the estimated time of death. Someone could have exploited this window.",
            choices: [
                { label: "Look for other evidence", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_look_entry"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The penthouse is on the 50th floor. All windows are sealed and intact. The only entrance is through the main door, which was double-locked from inside. There's a ventilation system, but the shafts are too small for a person.",
            choices: [
                { label: "Check for hidden passages", nextScene: "case1_hidden_passages" },
                { label: "Examine the safe room", nextScene: "case1_safe_room" },
                { label: "Return to main investigation", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_hidden_passages"] = {
            background: "bg-penthouse",
            speaker: "Officer Miller",
            text: "No hidden passages found. The building blueprints show this is a standard luxury penthouse layout. The previous owner was a paranoid art collector, but no modifications were made to the structure.",
            choices: [
                { label: "Continue searching", nextScene: "case1_look_entry" }
            ]
        };

        scenes["case1_safe_room"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The safe room is behind a bookshelf. It's sealed with a biometric lock. According to Mara, only Marcus knew how to open it. The forensic team will need to examine it.",
            choices: [
                { label: "Try to find another way in", nextScene: "case1_safe_room_attempt" },
                { label: "Return to main investigation", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_safe_room_attempt"] = {
            background: "bg-penthouse",
            speaker: "Forensic Expert",
            text: "We found something! There are faint scratch marks around the lock mechanism. Someone tried to force this open recently.",
            choices: [
                { label: "Document this evidence", nextScene: "case1_safe_room_evidence" }
            ]
        };

        scenes["case1_safe_room_evidence"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "This suggests someone tried to access the safe room. The killer might have been looking for something valuable. But how did they get into the penthouse in the first place?",
            choices: [
                { label: "Return to main investigation", nextScene: "case1_penthouse_arrival" }
            ],
            effect: function() { addClue("safeRoomTampered"); }
        };

        scenes["case1_find_weapon"] = {
            background: "bg-penthouse",
            speaker: "Forensic Expert",
            text: "No sign of the murder weapon in the penthouse. The wound suggests a thin, sharp blade about 6 inches long. Could be a hunting knife or similar weapon.",
            choices: [
                { label: "Check if anything is missing from the kitchen", nextScene: "case1_kitchen_check" },
                { label: "Look for blood traces", nextScene: "case1_blood_traces" },
                { label: "Return to body examination", nextScene: "case1_examine_body" }
            ]
        };

        scenes["case1_kitchen_check"] = {
            background: "bg-penthouse",
            speaker: "Officer Miller",
            text: "The kitchen knife set is complete. No missing knives. The victim didn't cook much anyway - mostly ordered in or had meals prepared.",
            choices: [
                { label: "So the killer brought their own weapon", nextScene: "case1_weapon_brought" }
            ]
        };

        scenes["case1_weapon_brought"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The killer came prepared with a weapon. This was premeditated, not a crime of passion. They knew they were going to kill Marcus.",
            choices: [
                { label: "Continue investigation", nextScene: "case1_find_weapon" }
            ],
            effect: function() { addClue("premeditated"); }
        };

        scenes["case1_blood_traces"] = {
            background: "bg-penthouse",
            speaker: "Forensic Expert",
            text: "Luminol reveals faint blood traces leading toward the balcony. Someone cleaned up, but not thoroughly enough.",
            choices: [
                { label: "Follow the blood trail", nextScene: "case1_blood_trail" }
            ]
        };

        scenes["case1_blood_trail"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The blood traces lead to the balcony. There are minute scratch marks on the railing. It looks like someone might have climbed up or down from here.",
            choices: [
                { label: "That's 50 floors up!", nextScene: "case1_balcony_reveal" }
            ]
        };

        scenes["case1_balcony_reveal"] = {
            background: "bg-penthouse",
            speaker: "Officer Miller",
            text: "Impossible! No one could climb 50 stories. But wait... maintenance records show window washers were working on this side of the building yesterday. They use suspended platforms.",
            choices: [
                { label: "Check the window washer schedule", nextScene: "case1_window_washers" },
                { label: "Look for other evidence on balcony", nextScene: "case1_balcony_evidence" }
            ]
        };

        scenes["case1_window_washers"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The window washing was scheduled for 2-4 PM yesterday. But the security gap was at 10:30 PM. Different timing.",
            choices: [
                { label: "Interview the window washers anyway", nextScene: "case1_interview_washers" },
                { label: "Return to balcony evidence", nextScene: "case1_balcony_evidence" }
            ]
        };

        scenes["case1_interview_washers"] = {
            background: "bg-police-station",
            speaker: "Window Washer",
            text: "Yeah, we were there yesterday afternoon. Everything was normal. We did notice one of the balcony doors was slightly open, but that happens sometimes. Rich folks forget to close things.",
            choices: [
                { label: "Was the door unlocked?", nextScene: "case1_washer_door" }
            ]
        };

        scenes["case1_washer_door"] = {
            background: "bg-police-station",
            speaker: "Window Washer",
            text: "Couldn't tell if it was unlocked, but it was definitely ajar. About two inches open. We didn't think much of it at the time.",
            choices: [
                { label: "This could be how the killer entered", nextScene: "case1_after_washers" }
            ],
            effect: function() { addClue("balconyDoorAjar"); }
        };

        scenes["case1_after_washers"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "So the killer could have accessed the balcony through the window washer platform, then entered through the slightly open door. But they would need to know the door would be open.",
            choices: [
                { label: "Continue investigation", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_balcony_evidence"] = {
            background: "bg-penthouse",
            speaker: "Forensic Expert",
            text: "We found a single strand of synthetic fiber caught on the balcony railing. Dark blue color. It doesn't match anything in the penthouse.",
            choices: [
                { label: "Bag it as evidence", nextScene: "case1_fiber_evidence" }
            ]
        };

        scenes["case1_fiber_evidence"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "This could be from the killer's clothing. Dark blue synthetic fiber - possibly from work clothes or outdoor gear.",
            choices: [
                { label: "Continue investigation", nextScene: "case1_penthouse_arrival" }
            ],
            effect: function() { addClue("fiberEvidence"); }
        };

        scenes["case1_personal_effects"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The victim's personal effects: wallet with cash and cards intact, expensive watch, phone. In his pocket, a folded note with the numbers '7-4-2-9' written on it.",
            choices: [
                { label: "What could this number mean?", nextScene: "case1_numbers_mean" },
                { label: "Check his phone", nextScene: "case1_check_phone" },
                { label: "Return to body examination", nextScene: "case1_examine_body" }
            ]
        };

        scenes["case1_numbers_mean"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "7-4-2-9. Could be a code, combination, or password. Might be related to the safe room or his computer.",
            choices: [
                { label: "Try it on the safe room", nextScene: "case1_try_safe_code" },
                { label: "Check his computer", nextScene: "case1_check_computer" }
            ],
            effect: function() { addClue("mysteriousNumbers"); }
        };

        scenes["case1_try_safe_code"] = {
            background: "bg-penthouse",
            speaker: "Officer Miller",
            text: "The safe room has a biometric lock, not a keypad. The numbers don't work here.",
            choices: [
                { label: "Check his computer instead", nextScene: "case1_check_computer" }
            ]
        };

        scenes["case1_check_computer"] = {
            background: "bg-penthouse",
            speaker: "Tech Specialist",
            text: "The computer is password protected. The numbers 7-4-2-9 don't work as the password. There is an encrypted file on the desktop labeled 'Merger Concerns'.",
            choices: [
                { label: "Try to bypass the security", nextScene: "case1_bypass_computer" },
                { label: "Look for other clues", nextScene: "case1_personal_effects" }
            ]
        };

        scenes["case1_bypass_computer"] = {
            background: "bg-penthouse",
            speaker: "Tech Specialist",
            text: "I've bypassed the security. The 'Merger Concerns' file contains emails showing Marcus was considering backing out of the Apex Industries merger. Alex would be furious - he'd lose millions.",
            choices: [
                { label: "Strong motive for Alex", nextScene: "case1_alex_motive" },
                { label: "Look for other files", nextScene: "case1_other_files" }
            ],
            effect: function() { 
                addClue("mergerConcerns"); 
                modifyTrust("alex", -2);
            }
        };

        scenes["case1_alex_motive"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "Alex had a strong financial motive. If Marcus backed out of the merger, Alex stood to lose everything. With Marcus dead, the merger would proceed under Alex's leadership.",
            choices: [
                { label: "Bring Alex in for questioning", nextScene: "case1_question_alex" },
                { label: "Look for more evidence first", nextScene: "case1_other_files" }
            ]
        };

        scenes["case1_other_files"] = {
            background: "bg-penthouse",
            speaker: "Tech Specialist",
            text: "There's another interesting file - personal correspondence with his ex-wife Elena. She was demanding more money from their divorce settlement, threatening to reveal damaging information about his business practices.",
            choices: [
                { label: "What kind of information?", nextScene: "case1_elena_blackmail" }
            ]
        };

        scenes["case1_elena_blackmail"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "Elena was threatening to reveal that Marcus had been using company funds for personal expenses - a serious legal violation. She wanted $5 million to keep quiet.",
            choices: [
                { label: "Motive for Elena too", nextScene: "case1_elena_motive" },
                { label: "Continue computer search", nextScene: "case1_computer_continue" }
            ],
            effect: function() { 
                addClue("elenaBlackmail"); 
                modifyTrust("elena", -1);
            }
        };

        scenes["case1_elena_motive"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "Elena needed money and Marcus was refusing to pay. With him dead, she might inherit through their divorce agreement or life insurance.",
            choices: [
                { label: "Bring Elena in for questioning", nextScene: "case1_question_elena" },
                { label: "Continue computer search", nextScene: "case1_computer_continue" }
            ]
        };

        scenes["case1_computer_continue"] = {
            background: "bg-penthouse",
            speaker: "Tech Specialist",
            text: "One more thing - security camera footage from the building across the street. It shows a figure on the balcony around 10:45 PM last night. The quality is poor, but the person appears to be wearing dark blue clothing.",
            choices: [
                { label: "That matches our fiber evidence!", nextScene: "case1_camera_match" }
            ],
            effect: function() { addClue("securityFootage"); }
        };

        scenes["case1_camera_match"] = {
            background: "bg-penthouse",
            speaker: "Detective",
            text: "The dark blue clothing matches the fiber we found. The timeline matches the security gap and estimated time of death. We're getting closer.",
            choices: [
                { label: "Continue investigation", nextScene: "case1_penthouse_arrival" }
            ]
        };

        scenes["case1_question_alex"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "This is ridiculous! Yes, we argued about the merger, but I would never hurt Marcus. We built this company together!",
            choices: [
                { label: "Where were you last night?", nextScene: "case1_alex_alibi" },
                { label: "We know about the merger concerns", nextScene: "case1_alex_merger" },
                { label: "Do you own dark blue work clothes?", nextScene: "case1_alex_clothing" }
            ]
        };

        scenes["case1_alex_alibi"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "I was at the Grand Hotel from 8 PM until morning. Business dinner with investors, then stayed the night. You can check with the hotel.",
            choices: [
                { label: "We will verify that", nextScene: "case1_alex_continue" }
            ]
        };

        scenes["case1_alex_merger"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "So you know Marcus was having second thoughts. Yes, I was angry. But killing him doesn't help me - the merger would likely fall through without him.",
            choices: [
                { label: "Not if you take control", nextScene: "case1_alex_control" }
            ]
        };

        scenes["case1_alex_control"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "The board would never let me lead alone. They loved Marcus. This actually hurts my position, not helps it.",
            choices: [
                { label: "Ask about clothing", nextScene: "case1_alex_clothing" }
            ]
        };

        scenes["case1_alex_clothing"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "Dark blue work clothes? I wear suits, Detective. Expensive ones. I don't own any 'work clothes' as you call them.",
            choices: [
                { label: "Continue questioning", nextScene: "case1_alex_continue" }
            ]
        };

        scenes["case1_alex_continue"] = {
            background: "bg-interview-room",
            speaker: "Alex",
            text: "Look, I'm sorry Marcus is dead. We had our differences, but he was my friend. I want you to find who did this.",
            choices: [
                { label: "Return to investigation", nextScene: "case1_after_interviews" }
            ]
        };

        scenes["case1_question_elena"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "About time you called me in. I assume you found my emails. Yes, I wanted more money. The settlement was unfair and Marcus knew it.",
            choices: [
                { label: "Where were you last night?", nextScene: "case1_elena_alibi" },
                { label: "Threatening someone is illegal", nextScene: "case1_elena_threats" },
                { label: "Do you benefit from his death?", nextScene: "case1_elena_benefit" }
            ]
        };

        scenes["case1_elena_alibi"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "I was at the charity gala at the Metropolitan Museum until 11 PM, then home with my sister. Dozens of people saw me.",
            choices: [
                { label: "We will check that", nextScene: "case1_elena_continue" }
            ]
        };

        scenes["case1_elena_threats"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "I wasn't threatening him, I was stating facts. He was misusing company funds. I have proof. I was going to the board, not the police.",
            choices: [
                { label: "That would have destroyed him", nextScene: "case1_elena_destroy" }
            ]
        };

        scenes["case1_elena_destroy"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "Exactly. So why would I kill him? With him dead, my leverage is gone. The company lawyers will tie everything up for years.",
            choices: [
                { label: "Ask about benefit", nextScene: "case1_elena_benefit" }
            ]
        };

        scenes["case1_elena_benefit"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "I get nothing from his death! Our divorce agreement specifically excluded me from his estate. I get exactly zero dollars if he dies. Check the paperwork!",
            choices: [
                { label: "We will", nextScene: "case1_elena_continue" }
            ]
        };

        scenes["case1_elena_continue"] = {
            background: "bg-interview-room",
            speaker: "Elena",
            text: "I'm sorry Marcus is dead, truly. We had our problems, but I didn't want this. Find who did this, Detective.",
            choices: [
                { label: "Return to investigation", nextScene: "case1_after_interviews" }
            ]
        };

        scenes["case1_after_interviews"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "Both Alex and Elena have motives, but also reasonable alibis. Alex doesn't seem like the type to climb balconies, and Elena has no financial benefit from the death. I need to keep looking.",
            choices: [
                { label: "Check the window washer alibis", nextScene: "case1_washer_alibis" },
                { label: "Re-examine the evidence", nextScene: "case1_reexamine_evidence" },
                { label: "Make an accusation", nextScene: "case1_accusation" }
            ]
        };

        scenes["case1_washer_alibis"] = {
            background: "bg-police-station",
            speaker: "Officer Miller",
            text: "The window washers all have solid alibis for last night. Most were together at a bowling tournament. They're cleared.",
            choices: [
                { label: "Back to investigation", nextScene: "case1_after_interviews" }
            ]
        };

        scenes["case1_reexamine_evidence"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "Let me look at what we have: the fiber evidence, security footage gap, balcony access, financial motives... Wait, I missed something. The numbers 7-4-2-9 - what if they're not a code but a time? 7:42 AM? Or 19:42?",
            choices: [
                { label: "Check security logs for 7:42", nextScene: "case1_check_742" },
                { label: "That doesn't make sense", nextScene: "case1_after_interviews" }
            ]
        };

        scenes["case1_check_742"] = {
            background: "bg-police-station",
            speaker: "Security Technician",
            text: "7:42 AM today? That's when Mara arrived. But wait... 19:42 yesterday - that's 7:42 PM. The logs show Mara entering then too. She said she left at 5 PM and didn't return until morning.",
            choices: [
                { label: "Confront Mara about this", nextScene: "case1_confront_mara" }
            ],
            effect: function() { addClue("maraLie"); }
        };

        scenes["case1_confront_mara"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "Alright, I lied. I came back at 7:42 PM because I forgot my tablet. But Marcus was fine then! We spoke briefly and I left. I didn't mention it because I didn't think it was important.",
            choices: [
                { label: "What did you talk about?", nextScene: "case1_mara_conversation" },
                { label: "What were you wearing?", nextScene: "case1_mara_clothing" }
            ]
        };

        scenes["case1_mara_conversation"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "He seemed nervous. Said he was expecting another visitor later. When I asked who, he said 'Just business.' He told me to take tomorrow off, which was unusual.",
            choices: [
                { label: "Who was the visitor?", nextScene: "case1_mara_visitor" }
            ]
        };

        scenes["case1_mara_visitor"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "I don't know! He wouldn't say. But... now that I think about it, he was looking at the security monitor when I left. The building directory showed Victor Stromwell was in the lobby.",
            choices: [
                { label: "Victor Stromwell?", nextScene: "case1_victor_reveal" }
            ]
        };

        scenes["case1_victor_reveal"] = {
            background: "bg-interview-room",
            speaker: "Detective",
            text: "Victor Stromwell - Marcus's biggest business rival. They've been fighting for years over patents. Victor owns a construction company and often wears dark blue work clothes.",
            choices: [
                { label: "The fiber evidence!", nextScene: "case1_victor_connection" }
            ]
        };

        scenes["case1_victor_connection"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "And Victor used to be a rock climber in college. He could have climbed between balconies or used equipment.",
            choices: [
                { label: "Bring Victor in", nextScene: "case1_question_victor" }
            ]
        };

        scenes["case1_mara_clothing"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "I was wearing a black dress. Why? ...Oh, the fiber evidence. That's not from me. But you know who always wears dark blue? Victor Stromwell. He owns Stromwell Construction.",
            choices: [
                { label: "Victor Stromwell?", nextScene: "case1_victor_reveal2" }
            ]
        };

        scenes["case1_victor_reveal2"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "Yes, Marcus's biggest rival. They've been fighting over patents for years. Victor was in the building yesterday evening - I saw him on the security monitor when I left.",
            choices: [
                { label: "And Victor was a rock climber", nextScene: "case1_victor_climber" }
            ]
        };

        scenes["case1_victor_climber"] = {
            background: "bg-interview-room",
            speaker: "Mara",
            text: "Exactly! He could have accessed the balcony. And he always wears those dark blue company jackets.",
            choices: [
                { label: "Bring Victor in", nextScene: "case1_question_victor" }
            ]
        };

        scenes["case1_question_victor"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "This is outrageous! Yes, I was in the building yesterday. Business meeting on the 38th floor. I never went to the penthouse.",
            choices: [
                { label: "We have evidence placing you there", nextScene: "case1_victor_evidence" },
                { label: "Where were you at 10:45 PM?", nextScene: "case1_victor_alibi" }
            ]
        };

        scenes["case1_victor_evidence"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "What evidence? I was home by 9 PM. My wife can verify that.",
            choices: [
                { label: "We have security footage", nextScene: "case1_victor_footage" },
                { label: "We found fibers from your clothing", nextScene: "case1_victor_fibers" }
            ]
        };

        scenes["case1_victor_footage"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "Impossible! The penthouse cameras were... I mean, there's no footage of me because I wasn't there!",
            choices: [
                { label: "How did you know about the camera gap?", nextScene: "case1_victor_slip" }
            ]
        };

        scenes["case1_victor_slip"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "I... I heard it from building security. Everyone knows about the maintenance schedule.",
            choices: [
                { label: "That information isn't public", nextScene: "case1_victor_trapped" }
            ]
        };

        scenes["case1_victor_trapped"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "Alright, fine! I was there. Marcus was stealing my patents. He was going to ruin me. I confronted him, we argued... it got out of hand.",
            choices: [
                { label: "So you killed him", nextScene: "case1_victor_confession" }
            ]
        };

        scenes["case1_victor_confession"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "It was an accident! He came at me with a letter opener. I defended myself. The knife was mine - I always carry it for protection. When I realized he was dead, I panicked. I used my climbing gear to get back to my office balcony two floors down.",
            choices: [
                { label: "Make the arrest", nextScene: "case1_ending_true" }
            ]
        };

        scenes["case1_victor_fibers"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "Many people wear dark blue! That proves nothing!",
            choices: [
                { label: "We also have witness placing you there", nextScene: "case1_victor_witness" }
            ]
        };

        scenes["case1_victor_witness"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "What witness? There was no one else there!",
            choices: [
                { label: "So you admit you were there", nextScene: "case1_victor_trapped2" }
            ]
        };

        scenes["case1_victor_trapped2"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "You tricked me! Alright, yes, I was there. Marcus was stealing my patents. We argued, he attacked me, I defended myself. It was an accident!",
            choices: [
                { label: "Make the arrest", nextScene: "case1_ending_true" }
            ]
        };

        scenes["case1_victor_alibi"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "I was home with my wife. She'll confirm it.",
            choices: [
                { label: "We already spoke to her", nextScene: "case1_victor_wife" }
            ]
        };

        scenes["case1_victor_wife"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "And? She confirmed I was home, right?",
            choices: [
                { label: "She said you came home at midnight", nextScene: "case1_victor_midnight" }
            ]
        };

        scenes["case1_victor_midnight"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "She must be mistaken! I was home all evening!",
            choices: [
                { label: "The security gap was 10:30-11:00 PM", nextScene: "case1_victor_timeline" }
            ]
        };

        scenes["case1_victor_timeline"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "I don't know anything about any security gap!",
            choices: [
                { label: "How do you explain the fiber evidence?", nextScene: "case1_victor_final" }
            ]
        };

        scenes["case1_victor_final"] = {
            background: "bg-interview-room",
            speaker: "Victor",
            text: "Alright, fine! I was there. Marcus was ruining me. I went to reason with him, we argued... it was an accident!",
            choices: [
                { label: "Make the arrest", nextScene: "case1_ending_true" }
            ]
        };

        // Case 1 Endings
        scenes["case1_accusation"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Alright Detective, it's time to make your accusation. Who killed Marcus Aethelred?",
            choices: [
                { 
                    label: "Mara - The Assistant", 
                    nextScene: function() { 
                        return "case1_ending_false";
                    } 
                },
                { 
                    label: "Alex - The Business Partner", 
                    nextScene: function() { 
                        return "case1_ending_false";
                    } 
                },
                { 
                    label: "Victor - The Rival CEO", 
                    nextScene: function() { 
                        if (gameState.clues.fiberEvidence && gameState.clues.securityFootage) {
                            return "case1_ending_true";
                        } else {
                            return "case1_ending_false";
                        }
                    } 
                },
                { 
                    label: "Elena - The Ex-Wife", 
                    nextScene: function() { 
                        return "case1_ending_false";
                    } 
                },
                { 
                    label: "I don't have enough evidence", 
                    nextScene: "case1_ending_unsolved" 
                }
            ]
        };

        scenes["case1_ending_true"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Excellent work, Detective. Your evidence was solid and Victor Stromwell has confessed. Another case closed thanks to your sharp investigative skills.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ],
            sfx: "crowd"
        };

        scenes["case1_ending_false"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "I'm afraid you've accused the wrong person. The real killer remains at large, and we've damaged an innocent person's reputation. This will have consequences.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        scenes["case1_ending_unsolved"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Without enough evidence to make an arrest, the case will remain open. The killer remains free, but perhaps new evidence will surface in time.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        // Case 2: Boardwalk incident
        scenes["case2_intro"] = {
            background: "bg-boardwalk",
            speaker: "Dispatch",
            text: "Detective, we have a possible homicide on the boardwalk. A local businessman, Benjamin Croft, was found dead this morning. Initially ruled as an accident, but there are suspicious circumstances.",
            choices: [
                { label: "Head to the boardwalk", nextScene: "case2_boardwalk_arrival" },
                { label: "Review the accident report", nextScene: "case2_review_report" }
            ],
            sfx: "sting"
        };

        scenes["case2_review_report"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "Benjamin Croft, 48, owner of Croft Imports. Found at the base of the boardwalk stairs with head trauma. Apparent fall, but no witnesses. Security cameras were malfunctioning.",
            choices: [
                { label: "Head to the boardwalk", nextScene: "case2_boardwalk_arrival" }
            ]
        };

        scenes["case2_boardwalk_arrival"] = {
            background: "bg-boardwalk",
            speaker: "Officer Miller",
            text: "Detective, the body was found here at 6 AM by a jogger. Looks like he fell from the upper deck, but the railing shows no damage. No signs of struggle either.",
            choices: [
                { label: "Examine the body location", nextScene: "case2_examine_body" },
                { label: "Check the upper deck", nextScene: "case2_upper_deck" },
                { label: "Look for witnesses", nextScene: "case2_find_witnesses" }
            ]
        };

        scenes["case2_examine_body"] = {
            background: "bg-boardwalk",
            speaker: "Forensic Expert",
            text: "The victim has severe head trauma consistent with a fall. However, there are also faint bruises on his arms, like someone grabbed him. Time of death between 11 PM and 1 AM.",
            choices: [
                { label: "Look for defensive wounds", nextScene: "case2_defensive_wounds" },
                { label: "Check his personal effects", nextScene: "case2_personal_effects" },
                { label: "Return to main investigation", nextScene: "case2_boardwalk_arrival" }
            ],
            effect: function() { addClue("armBruises"); }
        };

        scenes["case2_defensive_wounds"] = {
            background: "bg-boardwalk",
            speaker: "Forensic Expert",
            text: "No defensive wounds, but there's something under his fingernails - looks like fabric fibers. Blue cotton. We'll analyze it.",
            choices: [
                { label: "Bag it as evidence", nextScene: "case2_fiber_evidence" }
            ]
        };

        scenes["case2_fiber_evidence"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Blue cotton fibers under the fingernails. He might have grabbed his attacker's clothing during a struggle.",
            choices: [
                { label: "Continue investigation", nextScene: "case2_examine_body" }
            ],
            effect: function() { addClue("fiberEvidence"); }
        };

        scenes["case2_personal_effects"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Wallet with cash, expensive watch, phone. In his pocket, a receipt from 'The Salty Dog' bar dated yesterday evening. Time stamp: 10:30 PM.",
            choices: [
                { label: "Visit The Salty Dog", nextScene: "case2_salty_dog" },
                { label: "Check his phone", nextScene: "case2_check_phone" },
                { label: "Return to body examination", nextScene: "case2_examine_body" }
            ],
            effect: function() { addClue("barReceipt"); }
        };

        scenes["case2_check_phone"] = {
            background: "bg-boardwalk",
            speaker: "Tech Specialist",
            text: "Phone is password protected. Last call was to his business partner Jack at 9:45 PM. Several texts from his wife Isabella asking when he'd be home.",
            choices: [
                { label: "What do the texts say?", nextScene: "case2_isabella_texts" },
                { label: "Check other messages", nextScene: "case2_other_messages" }
            ]
        };

        scenes["case2_isabella_texts"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Isabella's texts start at 10 PM: 'Where are you?' Then at 11:15: 'This is getting ridiculous.' At midnight: 'We need to talk about this.' Sounds like an argument.",
            choices: [
                { label: "Motive for Isabella", nextScene: "case2_isabella_motive" },
                { label: "Check other messages", nextScene: "case2_other_messages" }
            ],
            effect: function() { addClue("argumentTexts"); }
        };

        scenes["case2_isabella_motive"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Marital problems could be a motive. If they were fighting and she knew he was at the boardwalk...",
            choices: [
                { label: "Continue phone examination", nextScene: "case2_other_messages" }
            ]
        };

        scenes["case2_other_messages"] = {
            background: "bg-boardwalk",
            speaker: "Tech Specialist",
            text: "There's an email from his business partner Jack: 'We need to discuss the buyout. Tonight.' Sent at 8 PM. Also a text from Olivia Sterling: 'Stay away from my business.'",
            choices: [
                { label: "Who is Olivia Sterling?", nextScene: "case2_olivia_info" },
                { label: "What buyout?", nextScene: "case2_buyout_info" },
                { label: "Return to investigation", nextScene: "case2_boardwalk_arrival" }
            ]
        };

        scenes["case2_olivia_info"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Olivia Sterling owns Sterling Souvenirs, the shop next to Croft Imports. They've been business rivals for years.",
            choices: [
                { label: "Motive for Olivia", nextScene: "case2_olivia_motive" },
                { label: "Check the buyout", nextScene: "case2_buyout_info" }
            ]
        };

        scenes["case2_olivia_motive"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Business rivalry can get intense. If Benjamin was threatening her livelihood...",
            choices: [
                { label: "Continue investigation", nextScene: "case2_other_messages" }
            ]
        };

        scenes["case2_buyout_info"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Jack wanted to buy out Benjamin's share of the business. Benjamin was refusing. This could be motive for Jack.",
            choices: [
                { label: "Strong financial motive", nextScene: "case2_jack_motive" },
                { label: "Return to investigation", nextScene: "case2_boardwalk_arrival" }
            ],
            effect: function() { addClue("buyoutDispute"); }
        };

        scenes["case2_jack_motive"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "With Benjamin dead, Jack would get full control of the business. Definitely worth investigating.",
            choices: [
                { label: "Continue investigation", nextScene: "case2_other_messages" }
            ]
        };

        scenes["case2_upper_deck"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "The upper deck has a great view of the ocean. The railing where he supposedly fell shows no damage or scuff marks. Strange for someone falling over it.",
            choices: [
                { label: "Look for evidence on the deck", nextScene: "case2_deck_evidence" },
                { label: "Check for security cameras", nextScene: "case2_deck_cameras" },
                { label: "Return to main investigation", nextScene: "case2_boardwalk_arrival" }
            ]
        };

        scenes["case2_deck_evidence"] = {
            background: "bg-boardwalk",
            speaker: "Forensic Expert",
            text: "We found scuff marks on the deck floor, like someone was dragged. Also, a single blue button caught in a crack. It doesn't match the victim's clothing.",
            choices: [
                { label: "Bag the button", nextScene: "case2_button_evidence" }
            ]
        };

        scenes["case2_button_evidence"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "A blue button, possibly from the attacker's clothing. This matches the fibers we found.",
            choices: [
                { label: "Continue investigation", nextScene: "case2_upper_deck" }
            ],
            effect: function() { addClue("buttonEvidence"); }
        };

        scenes["case2_deck_cameras"] = {
            background: "bg-boardwalk",
            speaker: "Officer Miller",
            text: "There's a security camera on the light pole, but it was vandalized yesterday. Maintenance was scheduled for today. Convenient timing.",
            choices: [
                { label: "Check nearby businesses for cameras", nextScene: "case2_nearby_cameras" },
                { label: "Return to deck investigation", nextScene: "case2_upper_deck" }
            ]
        };

        scenes["case2_nearby_cameras"] = {
            background: "bg-boardwalk",
            speaker: "Detective",
            text: "Sterling Souvenirs has a camera facing the street. It might have caught something.",
            choices: [
                { label: "Ask Olivia for the footage", nextScene: "case2_olivia_footage" },
                { label: "Get a warrant", nextScene: "case2_get_warrant" }
            ]
        };

        scenes["case2_olivia_footage"] = {
            background: "bg-docks",
            speaker: "Olivia Sterling",
            text: "My camera? It's been broken for weeks. I haven't gotten around to fixing it. Sorry, can't help you.",
            choices: [
                { label: "She's lying", nextScene: "case2_olivia_lie" },
                { label: "Check other businesses", nextScene: "case2_other_businesses" }
            ]
        };

        scenes["case2_olivia_lie"] = {
            background: "bg-docks",
            speaker: "Detective",
            text: "The camera light is on. It's clearly working. Why would she lie about this?",
            choices: [
                { label: "Confront her", nextScene: "case2_confront_olivia" },
                { label: "Get a warrant", nextScene: "case2_get_warrant" }
            ]
        };

        scenes["case2_confront_olivia"] = {
            background: "bg-docks",
            speaker: "Olivia Sterling",
            text: "Alright, fine! The camera works. But I don't have to show you anything without a warrant.",
            choices: [
                { label: "We'll be back with a warrant", nextScene: "case2_get_warrant" }
            ]
        };

        scenes["case2_get_warrant"] = {
            background: "bg-police-station",
            speaker: "Judge",
            text: "Based on the evidence, I'm issuing a warrant for the security footage from Sterling Souvenirs.",
            choices: [
                { label: "Collect the footage", nextScene: "case2_collect_footage" }
            ]
        };

        scenes["case2_collect_footage"] = {
            background: "bg-docks",
            speaker: "Tech Specialist",
            text: "We have the footage. It shows Benjamin arguing with someone on the upper deck around 11:30 PM. The person is wearing a blue jacket. The quality is poor, but we can enhance it.",
            choices: [
                { label: "Enhance the footage", nextScene: "case2_enhance_footage" }
            ],
            effect: function() { addClue("securityFootage"); }
        };

        scenes["case2_enhance_footage"] = {
            background: "bg-police-station",
            speaker: "Tech Specialist",
            text: "The enhanced footage shows Benjamin arguing with Jack. Jack is wearing a blue jacket. They struggle, and Jack pushes Benjamin over the railing.",
            choices: [
                { label: "Arrest Jack", nextScene: "case2_arrest_jack" }
            ]
        };

        scenes["case2_arrest_jack"] = {
            background: "bg-office",
            speaker: "Jack",
            text: "It was an accident! We were arguing about the buyout. He came at me, I pushed him away, and he went over the railing. I panicked and ran.",
            choices: [
                { label: "Make the arrest", nextScene: "case2_ending_true" }
            ]
        };

        scenes["case2_find_witnesses"] = {
            background: "bg-boardwalk",
            speaker: "Officer Miller",
            text: "We found a homeless man who sleeps under the boardwalk. He says he heard arguing around 11:30 PM, then a loud thud. He saw a man in a blue jacket running away.",
            choices: [
                { label: "Can he identify the man?", nextScene: "case2_witness_id" },
                { label: "Show him photos", nextScene: "case2_show_photos" }
            ],
            effect: function() { addClue("witnessAccount"); }
        };

        scenes["case2_witness_id"] = {
            background: "bg-boardwalk",
            speaker: "Witness",
            text: "It was dark, but he was average height, wearing a blue jacket. I didn't see his face.",
            choices: [
                { label: "Not much to go on", nextScene: "case2_boardwalk_arrival" }
            ]
        };

        scenes["case2_show_photos"] = {
            background: "bg-boardwalk",
            speaker: "Witness",
            text: "That's him! The one in the blue jacket in this photo. Jack, right? I've seen him around with Benjamin.",
            choices: [
                { label: "We have our suspect", nextScene: "case2_arrest_jack" }
            ]
        };

        scenes["case2_salty_dog"] = {
            background: "bg-docks",
            speaker: "Bartender",
            text: "Yeah, Benjamin was here last night. He was meeting with Jack. They left together around 11 PM. Both seemed angry.",
            choices: [
                { label: "Did you hear what they argued about?", nextScene: "case2_bartender_info" },
                { label: "Anyone else with them?", nextScene: "case2_other_patrons" }
            ]
        };

        scenes["case2_bartender_info"] = {
            background: "bg-docks",
            speaker: "Bartender",
            text: "Something about a business deal. Jack kept saying 'You're ruining everything' and Benjamin said 'It's my company too.'",
            choices: [
                { label: "Thanks for the information", nextScene: "case2_after_bar" }
            ],
            effect: function() { addClue("barArgument"); }
        };

        scenes["case2_other_patrons"] = {
            background: "bg-docks",
            speaker: "Bartender",
            text: "Olivia Sterling was here too, sitting at the other end of the bar. She left shortly after them.",
            choices: [
                { label: "Was she following them?", nextScene: "case2_olivia_following" },
                { label: "Return to investigation", nextScene: "case2_after_bar" }
            ]
        };

        scenes["case2_olivia_following"] = {
            background: "bg-docks",
            speaker: "Bartender",
            text: "Now that you mention it, she did seem to be watching them. She paid her tab right after they left.",
            choices: [
                { label: "Suspicious", nextScene: "case2_after_bar" }
            ]
        };

        scenes["case2_after_bar"] = {
            background: "bg-docks",
            speaker: "Detective",
            text: "So Benjamin and Jack left together angry, and Olivia may have followed them. Both have motives.",
            choices: [
                { label: "Continue investigation", nextScene: "case2_boardwalk_arrival" }
            ]
        };

        // Case 2 Endings
        scenes["case2_accusation"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Alright Detective, who killed Benjamin Croft?",
            choices: [
                { 
                    label: "Jack - Business Partner", 
                    nextScene: function() { 
                        if (gameState.clues.securityFootage || (gameState.clues.barArgument && gameState.clues.buttonEvidence)) {
                            return "case2_ending_true";
                        } else {
                            return "case2_ending_false";
                        }
                    } 
                },
                { 
                    label: "Olivia - Business Rival", 
                    nextScene: function() { 
                        return "case2_ending_false";
                    } 
                },
                { 
                    label: "Isabella - Wife", 
                    nextScene: function() { 
                        return "case2_ending_false";
                    } 
                },
                { 
                    label: "Accident", 
                    nextScene: function() { 
                        return "case2_ending_false";
                    } 
                },
                { 
                    label: "Not enough evidence", 
                    nextScene: "case2_ending_unsolved" 
                }
            ]
        };

        scenes["case2_ending_true"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Excellent work. Jack has confessed to pushing Benjamin during an argument. It might have been unintentional, but he fled the scene and failed to report it.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ],
            sfx: "crowd"
        };

        scenes["case2_ending_false"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Wrong suspect. The real killer remains free, and we've compromised the investigation.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        scenes["case2_ending_unsolved"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Without conclusive evidence, we can't make an arrest. The case will be filed as unsolved.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        // Case 3: Theater poisoning
        scenes["case3_intro"] = {
            background: "bg-theater",
            speaker: "Dispatch",
            text: "Detective, we have a situation at the Grand Opera House. Celebrated actress Sophia LaRue collapsed during last night's performance and was pronounced dead at the scene. Initial tox screen suggests poisoning.",
            choices: [
                { label: "Head to the theater", nextScene: "case3_theater_arrival" },
                { label: "Review the victim's background", nextScene: "case3_review_background" }
            ],
            sfx: "sting"
        };

        scenes["case3_review_background"] = {
            background: "bg-police-station",
            speaker: "Detective",
            text: "Sophia LaRue, 34, lead actress in 'Midnight Sonata.' No known health issues. Had conflicts with several cast members according to theater gossip.",
            choices: [
                { label: "Head to the theater", nextScene: "case3_theater_arrival" }
            ]
        };

        scenes["case3_theater_arrival"] = {
            background: "bg-theater",
            speaker: "Officer Miller",
            text: "Detective, Sophia collapsed during the second act. She was drinking from a prop wine glass moments before. The glass tested positive for cyanide.",
            choices: [
                { label: "Examine the crime scene", nextScene: "case3_examine_scene" },
                { label: "Question the cast", nextScene: "case3_question_cast" },
                { label: "Check backstage", nextScene: "case3_backstage" }
            ]
        };

        scenes["case3_examine_scene"] = {
            background: "bg-theater",
            speaker: "Forensic Expert",
            text: "The prop wine glass has traces of cyanide. Only Sophia's fingerprints are on it. The bottle backstage is clean. Someone poisoned just her glass.",
            choices: [
                { label: "Check for other evidence", nextScene: "case3_more_evidence" },
                { label: "Who had access to the glass?", nextScene: "case3_glass_access" },
                { label: "Return to main investigation", nextScene: "case3_theater_arrival" }
            ],
            effect: function() { addClue("poisonedGlass"); }
        };

        scenes["case3_more_evidence"] = {
            background: "bg-theater",
            speaker: "Forensic Expert",
            text: "We found a small vial backstage containing residue that matches the poison. No fingerprints though.",
            choices: [
                { label: "Bag the vial", nextScene: "case3_vial_evidence" }
            ]
        };

        scenes["case3_vial_evidence"] = {
            background: "bg-theater",
            speaker: "Detective",
            text: "A poison vial backstage. The killer must have disposed of it in a hurry.",
            choices: [
                { label: "Continue investigation", nextScene: "case3_examine_scene" }
            ],
            effect: function() { addClue("poisonVial"); }
        };

        scenes["case3_glass_access"] = {
            background: "bg-theater",
            speaker: "Stage Manager",
            text: "The prop master prepares the glasses before the show. Then they're placed on a tray backstage. Several people had access: the understudy Marco, the director Arthur, and Sophia herself.",
            choices: [
                { label: "Who benefits from her death?", nextScene: "case3_benefactors" },
                { label: "Check alibis", nextScene: "case3_check_alibis" }
            ]
        };

        scenes["case3_benefactors"] = {
            background: "bg-theater",
            speaker: "Detective",
            text: "Marco becomes the lead if Sophia is gone. Arthur had creative differences with her. And Victoria, her understudy, gets promoted.",
            choices: [
                { label: "Multiple motives", nextScene: "case3_glass_access" }
            ]
        };

        scenes["case3_check_alibis"] = {
            background: "bg-theater",
            speaker: "Officer Miller",
            text: "During the poisoning window, Marco was in his dressing room, Arthur was watching from the audience, and Victoria was in the green room.",
            choices: [
                { label: "Anyone could have done it", nextScene: "case3_glass_access" }
            ]
        };

        scenes["case3_question_cast"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "The cast is gathered in the green room. Who do you want to question first?",
            choices: [
                { label: "Marco - The Understudy", nextScene: "case3_question_marco" },
                { label: "Victoria - Rival Actress", nextScene: "case3_question_victoria" },
                { label: "Arthur - The Director", nextScene: "case3_question_arthur" },
                { label: "Return to investigation", nextScene: "case3_theater_arrival" }
            ]
        };

        scenes["case3_question_marco"] = {
            background: "bg-backstage",
            speaker: "Marco",
            text: "I can't believe she's gone. Yes, I'm the understudy, but I would never hurt Sophia. We were friends!",
            choices: [
                { label: "Where were you before the show?", nextScene: "case3_marco_alibi" },
                { label: "Did you have issues with Sophia?", nextScene: "case3_marco_issues" },
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_marco_alibi"] = {
            background: "bg-backstage",
            speaker: "Marco",
            text: "I was in my dressing room until curtain call. My dresser can confirm that.",
            choices: [
                { label: "We'll verify that", nextScene: "case3_marco_continue" }
            ]
        };

        scenes["case3_marco_issues"] = {
            background: "bg-backstage",
            speaker: "Marco",
            text: "We had some creative differences, but nothing serious. She was difficult to work with sometimes, but that's true of many talented actors.",
            choices: [
                { label: "Continue questioning", nextScene: "case3_marco_continue" }
            ]
        };

        scenes["case3_marco_continue"] = {
            background: "bg-backstage",
            speaker: "Marco",
            text: "Look, I admired Sophia. I wouldn't kill her just to get the lead role. That's monstrous!",
            choices: [
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_question_victoria"] = {
            background: "bg-backstage",
            speaker: "Victoria",
            text: "This is terrible! Sophia and I had our differences, but I would never wish this on anyone.",
            choices: [
                { label: "What differences?", nextScene: "case3_victoria_differences" },
                { label: "Where were you before the show?", nextScene: "case3_victoria_alibi" },
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_victoria_differences"] = {
            background: "bg-backstage",
            speaker: "Victoria",
            text: "She got the lead role that I was promised. The director changed his mind at the last minute. But I've moved on.",
            choices: [
                { label: "That sounds like a strong motive", nextScene: "case3_victoria_motive" }
            ],
            effect: function() { addClue("roleStolen"); }
        };

        scenes["case3_victoria_motive"] = {
            background: "bg-backstage",
            speaker: "Victoria",
            text: "Are you accusing me? I have an alibi! I was with the costume designer until five minutes before curtain.",
            choices: [
                { label: "We'll check that", nextScene: "case3_victoria_continue" }
            ]
        };

        scenes["case3_victoria_alibi"] = {
            background: "bg-backstage",
            speaker: "Victoria",
            text: "I was in the green room with several other cast members. They can all vouch for me.",
            choices: [
                { label: "We'll verify that", nextScene: "case3_victoria_continue" }
            ]
        };

        scenes["case3_victoria_continue"] = {
            background: "bg-backstage",
            speaker: "Victoria",
            text: "I'm devastated by what happened, but I'm innocent. You're wasting time questioning me.",
            choices: [
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_question_arthur"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "A tragedy! Sophia was brilliant, if difficult. This will close the production.",
            choices: [
                { label: "What do you mean 'difficult'?", nextScene: "case3_arthur_difficult" },
                { label: "Where were you before the show?", nextScene: "case3_arthur_alibi" },
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_arthur_difficult"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "She was demanding rewrites, changing blocking, arguing with everyone. The insurance on this production is substantial though.",
            choices: [
                { label: "Insurance?", nextScene: "case3_insurance_info" }
            ]
        };

        scenes["case3_insurance_info"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "The show is insured against the lead actor being unable to perform. With Sophia gone, we collect the insurance money.",
            choices: [
                { label: "Financial motive", nextScene: "case3_arthur_motive" }
            ],
            effect: function() { addClue("insuranceMoney"); }
        };

        scenes["case3_arthur_motive"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "That's ridiculous! The insurance doesn't cover murder. I'd be the prime suspect!",
            choices: [
                { label: "Continue questioning", nextScene: "case3_arthur_continue" }
            ]
        };

        scenes["case3_arthur_alibi"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "I was in the audience talking to critics until five minutes before the show. Then I went backstage briefly before taking my seat.",
            choices: [
                { label: "You were backstage?", nextScene: "case3_arthur_backstage" }
            ]
        };

        scenes["case3_arthur_backstage"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "Just to wish everyone luck! I didn't go near the props.",
            choices: [
                { label: "We'll verify that", nextScene: "case3_arthur_continue" }
            ]
        };

        scenes["case3_arthur_continue"] = {
            background: "bg-backstage",
            speaker: "Arthur",
            text: "I want Sophia's killer found as much as you do. This is my production, my reputation!",
            choices: [
                { label: "Question someone else", nextScene: "case3_question_cast" }
            ]
        };

        scenes["case3_backstage"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "The backstage area is crowded with props, costumes, and dressing rooms. The prop table where the wine glass was kept is near the stage entrance.",
            choices: [
                { label: "Search Marco's dressing room", nextScene: "case3_search_marco" },
                { label: "Search Victoria's dressing room", nextScene: "case3_search_victoria" },
                { label: "Search Arthur's office", nextScene: "case3_search_arthur" },
                { label: "Return to main investigation", nextScene: "case3_theater_arrival" }
            ]
        };

        scenes["case3_search_marco"] = {
            background: "bg-backstage",
            speaker: "Officer Miller",
            text: "We found a chemistry textbook in Marco's dressing room with pages bookmarked about poisons. Also, a love letter to Sophia that was never sent.",
            choices: [
                { label: "Suspicious", nextScene: "case3_marco_evidence" }
            ],
            effect: function() { addClue("chemistryBook"); }
        };

        scenes["case3_marco_evidence"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "A chemistry book with poison information and an unrequited love for Sophia. Either could be motive.",
            choices: [
                { label: "Continue searching", nextScene: "case3_backstage" }
            ]
        };

        scenes["case3_search_victoria"] = {
            background: "bg-backstage",
            speaker: "Officer Miller",
            text: "Victoria's dressing room has newspaper clippings about Sophia's career with angry notes written in the margins. 'My role' circled repeatedly.",
            choices: [
                { label: "Strong resentment", nextScene: "case3_victoria_evidence" }
            ],
            effect: function() { addClue("angryClippings"); }
        };

        scenes["case3_victoria_evidence"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "Victoria clearly resented Sophia for taking her role. This could have pushed her over the edge.",
            choices: [
                { label: "Continue searching", nextScene: "case3_backstage" }
            ]
        };

        scenes["case3_search_arthur"] = {
            background: "bg-backstage",
            speaker: "Officer Miller",
            text: "Arthur's office has financial documents showing the production was massively over budget. The insurance payout would save him from bankruptcy.",
            choices: [
                { label: "Financial pressure", nextScene: "case3_arthur_evidence" }
            ],
            effect: function() { addClue("financialTrouble"); }
        };

        scenes["case3_arthur_evidence"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "Arthur was under severe financial pressure. The insurance money would solve his problems.",
            choices: [
                { label: "Continue searching", nextScene: "case3_backstage" }
            ]
        };

        scenes["case3_check_dresser"] = {
            background: "bg-backstage",
            speaker: "Marco's Dresser",
            text: "Marco was in his dressing room most of the time, but he did leave for about ten minutes to 'get some air.' That was about 30 minutes before curtain.",
            choices: [
                { label: "Enough time to poison the glass", nextScene: "case3_marco_opportunity" }
            ],
            effect: function() { addClue("marcoAlibiBroken"); }
        };

        scenes["case3_marco_opportunity"] = {
            background: "bg-backstage",
            speaker: "Detective",
            text: "Marco had the opportunity. With the chemistry knowledge and unrequited love, he's looking like our prime suspect.",
            choices: [
                { label: "Confront Marco", nextScene: "case3_confront_marco" }
            ]
        };

        scenes["case3_confront_marco"] = {
            background: "bg-backstage",
            speaker: "Marco",
            text: "Alright, yes! I loved her! When she rejected me, I was angry. I thought if I made her sick, I could care for her and she'd see how much I loved her. I didn't mean to kill her!",
            choices: [
                { label: "Arrest him", nextScene: "case3_ending_true" }
            ]
        };

        // Case 3 Endings
        scenes["case3_accusation"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Alright Detective, who poisoned Sophia LaRue?",
            choices: [
                { 
                    label: "Marco - The Understudy", 
                    nextScene: function() { 
                        if (gameState.clues.chemistryBook && gameState.clues.marcoAlibiBroken) {
                            return "case3_ending_true";
                        } else {
                            return "case3_ending_false";
                        }
                    } 
                },
                { 
                    label: "Victoria - Rival Actress", 
                    nextScene: function() { 
                        return "case3_ending_false";
                    } 
                },
                { 
                    label: "Arthur - The Director", 
                    nextScene: function() { 
                        return "case3_ending_false";
                    } 
                },
                { 
                    label: "Accident", 
                    nextScene: function() { 
                        return "case3_ending_false";
                    } 
                },
                { 
                    label: "Not enough evidence", 
                    nextScene: "case3_ending_unsolved" 
                }
            ]
        };

        scenes["case3_ending_true"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Excellent work. Marco has confessed to the poisoning. He meant to make her ill, not kill her, but his actions still resulted in murder.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ],
            sfx: "crowd"
        };

        scenes["case3_ending_false"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Wrong suspect. The real poisoner remains free to potentially strike again.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        scenes["case3_ending_unsolved"] = {
            background: "bg-police-station",
            speaker: "Captain",
            text: "Without enough evidence, we can't make an arrest. The case will remain open, but leads are growing cold.",
            choices: [
                { label: "Return to main menu", nextScene: "main_menu" }
            ]
        };

        // Game Functions
        function showScene(sceneId) {
            const scene = scenes[sceneId];
            if (!scene) {
                console.error("Scene not found:", sceneId);
                return;
            }

            // Update background
            document.getElementById("background").className = scene.background;
            
            // Update speaker and text
            document.getElementById("speaker-name").textContent = scene.speaker;
            document.getElementById("dialogue-text").textContent = scene.text;
            
            // Clear previous choices
            const choicesContainer = document.getElementById("choices-container");
            choicesContainer.innerHTML = "";
            
            // Add new choices
            scene.choices.forEach(choice => {
                const button = document.createElement("button");
                button.className = "choice-btn";
                button.textContent = choice.label;
                
                button.addEventListener("click", () => {
                    // Play click sound
                    sounds.click.play().catch(e => console.log("Audio play failed:", e));
                    
                    // Apply any effect
                    if (choice.effect) {
                        choice.effect();
                    }
                    
                    // Determine next scene
                    let nextSceneId;
                    if (typeof choice.nextScene === "function") {
                        nextSceneId = choice.nextScene();
                    } else {
                        nextSceneId = choice.nextScene;
                    }
                    
                    // Handle special scenes
                    if (nextSceneId === "main_menu") {
                        showMainMenu();
                    } else {
                        showScene(nextSceneId);
                    }
                });
                
                choicesContainer.appendChild(button);
            });
            
            // Play sound effect if specified
            if (scene.sfx && sounds[scene.sfx]) {
                sounds[scene.sfx].play().catch(e => console.log("Audio play failed:", e));
            }
        }

        function showMainMenu() {
            document.getElementById("main-menu").style.display = "flex";
            document.getElementById("game-screen").style.display = "none";
            document.getElementById("ending-screen").style.display = "none";
            
            // Reset game state
            gameState.currentCase = null;
            gameState.clues = {};
            gameState.suspectTrust = {
                mara: 0,
                alex: 0,
                victor: 0,
                elena: 0,
                benjamin: 0,
                isabella: 0,
                jack: 0,
                olivia: 0,
                marco: 0,
                victoria: 0,
                arthur: 0
            };
            gameState.flags = {};
        }

        function startCase(caseNumber) {
            gameState.currentCase = caseNumber;
            document.getElementById("main-menu").style.display = "none";
            document.getElementById("game-screen").style.display = "flex";
            document.getElementById("ending-screen").style.display = "none";
            
            // Start the appropriate case
            showScene(`case${caseNumber}_intro`);
        }

        // Utility functions for game logic
        function addClue(clueId) {
            gameState.clues[clueId] = true;
            console.log("Clue added:", clueId);
        }

        function modifyTrust(suspect, amount) {
            gameState.suspectTrust[suspect] += amount;
            console.log(`Trust modified: ${suspect} now at ${gameState.suspectTrust[suspect]}`);
        }

        // Notepad functionality
        function toggleNotepad() {
            const notepadContainer = document.getElementById("notepad-container");
            if (notepadContainer.style.display === "none") {
                notepadContainer.style.display = "flex";
                document.getElementById("notepad").value = gameState.notes;
            } else {
                notepadContainer.style.display = "none";
                // Save notes to game state
                gameState.notes = document.getElementById("notepad").value;
            }
        }

        function saveNotes() {
            gameState.notes = document.getElementById("notepad").value;
        }

        // Event Listeners
        document.addEventListener("DOMContentLoaded", () => {
            // Case selection buttons
            document.querySelectorAll(".case-btn").forEach(button => {
                button.addEventListener("click", (e) => {
                    const caseNumber = e.target.getAttribute("data-case");
                    startCase(caseNumber);
                });
            });
            
            // Game control buttons
            document.getElementById("toggle-notepad").addEventListener("click", toggleNotepad);
            document.getElementById("restart-case-btn").addEventListener("click", () => {
                if (gameState.currentCase) {
                    startCase(gameState.currentCase);
                }
            });
            document.getElementById("main-menu-btn").addEventListener("click", showMainMenu);
            
            // Notepad auto-save
            document.getElementById("notepad").addEventListener("input", saveNotes);
            
            // Ending screen buttons
            document.getElementById("restart-case").addEventListener("click", () => {
                if (gameState.currentCase) {
                    startCase(gameState.currentCase);
                }
            });
            
            document.getElementById("return-menu").addEventListener("click", showMainMenu);
            
            // Initialize with main menu
            showMainMenu();
        });
    </script>
</body>
</html>
